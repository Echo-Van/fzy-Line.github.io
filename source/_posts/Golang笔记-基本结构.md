---
title: Golang笔记-基本结构
tags: Golang
categories:
  - Programming language
  - Golang
abbrlink: 25877
date: 2018-08-21 15:42:02
---

<center>Golang 程序基本结构学习。</center>

<!--more-->

　　程序一般由关键字、常量、变量、运算符、类型和函数组成。程序中可能会使用到这些分隔符：括号 `()`，中括号 `[]` 和大括号 `{}`。程序中可能会使用到这些标点符号：`.`、`,`、`;`、`:` 和 `…`。程序的代码通过语句来实现结构化。每个语句不需要像 C 家族中的其它语言一样以分号 `;` 结尾，因为这些工作都将由 Go 编译器自动完成。

#### 标识符

　　有效的标识符必须以字符（可以使用任何 UTF-8 编码的字符或 `_`）开头，然后紧跟着 0 个或多个字符或 Unicode 数字。

　　`_` 是一个特殊的标识符，被称为空白标识符。它可以像其他标识符那样用于变量的声明或赋值（任何类型都可以赋值给它），但任何赋给这个标识符的值都将被抛弃，因此这些值不能在后续的代码中使用，也不可以使用这个标识符作为变量对其它变量进行赋值或运算。

#### 关键字

Go 语言中定义的25个关键字：

| break    | default     | func   | interface | select |
| -------- | ----------- | ------ | --------- | ------ |
| case     | defer       | go     | map       | struct |
| chan     | else        | goto   | package   | switch |
| const    | fallthrough | if     | range     | type   |
| continue | for         | import | return    | var    |




**分类整理：**

- 基本结构
  - 变量、常量：`var` `const`
  - 包管理：`package` `import`
- 基本组件
  - 函数：`func` `return`
  - 自定义类型：`interface` `struct` `type`
  - 引用类型：`map` `range`
- 流程控制
  - 并发：`go` `select` `chan`
  - 单分支流程：`if` `else`
  - 多分支流程：`switch` `case` `default` `fallthrough`
  - 循环流程：`for` `break` `continue`
  - `goto`
  - `defer`



#### 基本结构

Go 语言版 hello world ：

```go
package main

import "fmt"

func main() {
	fmt.Println("hello, world")
}
```

##### 包

　　包是结构化代码的一种方式：每个程序都由包的概念组成，可以使用自身的包或者从其它包中导入内容。如同其它一些编程语言中的类库或命名空间的概念，每个 Go 文件都属于且仅属于一个包。一个包可以由许多以 `.go` 为扩展名的源文件组成，因此文件名和包名一般来说都是不相同的。

　　如上，在源文件中非注释的第一行指明这个文件属于哪个包，如：`package main`。`package main`表示一个可独立执行的程序，每个 Go 应用程序都包含一个名为 `main` 的包。

　　一个应用程序可以包含不同的包，而且即使你只使用 main 包也不必把所有的代码都写在一个巨大的文件里：你可以用一些较小的文件，并且在每个文件非注释的第一行都使用 `package main` 来指明这些文件都属于 main 包。另外要注意的是，所有的包名都应该使用小写字母。

　　一个 Go 程序是通过 `import` 关键字将一组包链接在一起。`import "fmt"` 告诉 Go 编译器这个程序需要使用 `fmt` 包（的函数，或其他元素），`fmt` 包实现了格式化 IO（输入/输出）的函数。包名被封闭在半角双引号 `""` 中。如果你打算从已编译的包中导入并加载公开声明的方法，不需要插入已编译包的源代码。

　　如果需要多个包，它们可以被分别导入：

```go
import "fmt"
import "os"
```

　　或（该方式被称为因式分解关键字，同样适用于 const、var 和 type 的声明或定义）：

```go
import (
   "fmt"
   "os"
)
```

　　如果你导入了一个包却没有使用它，则会在构建程序时引发错误，如 `imported and not used: os`，这正是遵循了 Go 的格言：“没有不必要的代码！“。

　　包也可以作为命名空间使用，帮助避免命名冲突（名称冲突）：两个包中的同名变量的区别在于他们的包名，例如 `pack1.Thing` 和 `pack2.Thing`。另外，可以通过使用包的别名来解决包名之间的名称冲突，或者说根据你的个人喜好对包名进行重新设置，如：`import fm "fmt"`。

##### 函数

　　`main` 函数是每一个可执行程序所必须包含的，一般来说都是在启动后第一个执行的函数（如果有 `init()` 函数则会先执行该函数）。如果你的 `main` 包的源代码没有包含 `main` 函数，则会引发构建错误 `undefined: main.main`。`main` 函数既没有参数，也没有返回类型。

　　函数里的代码（函数体）使用大括号 `{}` 括起来。左大括号 `{` 必须与方法的声明放在同一行，这是编译器的强制规定。对于大括号 `{}` 的使用规则在任何时候都是相同的（如：if 语句等）。

　　只有当某个函数需要被外部包调用的时候才使用大写字母开头，并遵循 Pascal 命名法；否则就遵循骆驼命名法，即第一个单词的首字母小写，其余单词的首字母大写。

　　如上，`fmt.Println("hello, world")` 调用了 `fmt` 包中的 `Println` 函数，可以将字符串输出到控制台，并在最后自动增加换行字符 `\n` 。

##### Go 程序基本思路

- 在完成包的 import 之后，开始对常量、变量和类型的定义或声明。
- 如果存在 init 函数的话，则对该函数进行定义（这是一个特殊的函数，每个含有该函数的包都会首先执行这个函数）。
- 如果当前包是 main 包，则定义 main 函数。
- 然后定义其余的函数，首先是类型的方法，接着是按照 main 函数中先后调用的顺序来定义相关函数，如果有很多函数，则可以按照字母顺序来进行排序。

##### Go 程序执行顺序

- 按顺序导入所有被 main 包引用的其它包，然后在每个包中执行如下流程：
- 如果该包又导入了其它的包，则从第一步开始递归执行，但是每个包只会被导入一次。
- 然后以相反的顺序在每个包中初始化常量和变量，如果该包含有 init 函数的话，则调用该函数。
- 在完成这一切之后，main 也执行同样的过程，最后调用 main 函数开始执行程序。

##### 命名规范与可见性规则

　　Go 语言中对象的命名也应该是简洁且有意义的。名称不需要指出自己所属的包，因为在调用的时候会使用包名作为限定符。返回某个对象的函数或方法的名称一般都是使用名词，没有 `Get...` 之类的字符，如果是用于修改某个对象，则使用 `SetName`。有必须要的话可以使用大小写混合的方式，如 MixedCaps 或 mixedCaps，而不是使用下划线来分割多个名称。

　　当标识符（包括常量、变量、类型、函数名、结构字段等等）以一个**大写字母开头**，那么使用这种形式的标识符的对象就可以被外部包的代码所使用（客户端程序需要先导入这个包），这被称为导出（像面向对象语言中的 **public** ）；标识符如果以**小写字母开头**，则对包外是不可见的，但是他们在整个包的内部是可见并且可用的（像面向对象语言中的 **private** ）。